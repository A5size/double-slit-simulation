This README is generated by ChatGPT.  
このREADMEはChatGPTによって生成されました。

# Double Slit Quantum Simulation  
二重スリット量子シミュレーション

![Simulation Image](fig/double_slit.png)  
シミュレーション画像

---

## Overview  
概要

This project demonstrates a double-slit quantum simulation using Fortran for high-performance numerical calculations and Python (via `ctypes`) for visualization.  
このプロジェクトは、高速な数値計算にFortranを用い、`ctypes`を介してPythonから呼び出すことで、二重スリットの量子シミュレーションを可視化する例を示します。

A 2D Schrödinger equation is solved with a finite-difference + 4th-order Runge–Kutta (RK4) method.  
2次元のシュレディンガー方程式を有限差分法と4次のルンゲ＝クッタ法(RK4)で解きます。

Specifically, the code solves the following equation:  
具体的には、次の方程式を解きます。

$ i \frac{\partial \Psi}{\partial t} = -\frac{1}{2} \nabla^2 \Psi + V \Psi $

The resulting wavefunction (probability density) is animated using Matplotlib in Python.  
計算結果の波動関数（確率密度）は、PythonのMatplotlibでアニメーション表示されます。

---

## Features  
特徴

- **Fortran Code (qm.f90)**  
  Fortran code implements the numerical solution of the 2D Schrödinger equation:  
  `$ i \frac{\partial \Psi}{\partial t} = -\frac{1}{2} \nabla^2 \Psi + V \Psi $`

  2次元シュレディンガー方程式  
  `$ i \frac{\partial \Psi}{\partial t} = -\frac{1}{2} \nabla^2 \Psi + V \Psi $`
  を数値的に解くFortranコードです。  

  - Initializes Gaussian wave packets  
    ガウス波束の初期化機能があります。

  - Sets up double-slit potential barriers  
    二重スリットのポテンシャル障壁を設定できます。

  - Performs time evolution via RK4  
    ルンゲ＝クッタ法(RK4)により時間発展を行います。

- **Python Wrapper (QMLib.py)**  
  Provides a convenient interface using `ctypes` to call the Fortran routines from Python.  
  Python側でFortranのサブルーチンを呼び出すための`ctypes`ラッパーを提供します。

- **Simulation Scripts**  
  シミュレーションスクリプト

  - **double_slit_simulation.py**  
    Offers advanced visualization, slicing through the wavefunction, and comparison to Fraunhofer diffraction theory.  
    詳細な可視化や、波動関数の断面表示、フラウンホーファー回折の理論との比較を行うスクリプトです。

  - **simplified_double_slit_simulation.py**  
    A minimalistic script focusing on a simple 2D heatmap animation of the wavefunction.  
    波動関数の2次元ヒートマップによるアニメーション表示に特化したシンプルなスクリプトです。

---

## Requirements  
必要環境

- A Fortran compiler (e.g., gfortran)  
  Fortranコンパイラ（例：gfortran）

- Python 3.x  
  Python 3系

  - numpy  
    numpy

  - matplotlib  
    matplotlib

  - tqdm (used in the more detailed simulation script)  
    tqdm（詳細なシミュレーションで使用）

- Linux or macOS preferred (Windows works with WSL or an appropriate Fortran setup)  
  LinuxまたはmacOS推奨（WindowsではWSLなどでFortran環境を構築すれば動作可能）

---

## Setup Instructions  
セットアップ手順

1. **Build the Fortran Library**  
   In the `lib` directory, compile the Fortran code to create `libfort.so` (shared library).  
   `lib`ディレクトリでFortranコードをコンパイルし、共有ライブラリ`libfort.so`を生成します。

   @@@
   cd lib
   ./compile.sh
   @@@

   or run a similar command manually:  
   または、次のように手動でコンパイルしてください。

   @@@
   gfortran -shared -fPIC qm.f90 -o libfort.so
   @@@

2. **Install Python Dependencies**  
   Pythonの依存関係をインストールします。

   @@@
   pip install numpy matplotlib tqdm
   @@@

3. **Run the Simulation**  
   シミュレーションを実行します。

   - For full-featured visualization:  
     詳細な可視化の場合:

     @@@
     python double_slit_simulation.py
     @@@

   - For a simplified animation:  
     シンプルなアニメーションの場合:

     @@@
     python simplified_double_slit_simulation.py
     @@@

---

## Usage Highlights  
使い方のポイント

- **double_slit_simulation.py**  
  Uses a `SimulationConfig` dataclass to adjust parameters like grid size, Gaussian wave packet setup, and double-slit geometry.  
  `SimulationConfig` (dataclass)を使用して、グリッドサイズやガウス波束のパラメータ、二重スリットの形状などを指定します。

  Displays heatmaps, cross-sectional plots, and a theoretical Fraunhofer diffraction curve.  
  ヒートマップや断面プロット、フラウンホーファー回折の理論曲線を可視化します。

  Animates the time evolution of the wave packet passing through the double-slit.  
  波束が二重スリットを通過していく時間発展をアニメーション表示します。

- **simplified_double_slit_simulation.py**  
  Demonstrates only the essential steps (initialize solver, set Gaussian packet, set potential, animate).  
  ソルバー初期化、ガウス波束設定、ポテンシャル設定、アニメ表示といった最小限のステップのみを示します。

  Provides a concise example for learning or testing.  
  学習やテストに適した簡潔な例となっています。

---

## License  
ライセンス

This project is released under the [MIT License](https://opensource.org/licenses/MIT).  
本プロジェクトは[MIT License](https://opensource.org/licenses/MIT)のもとで公開されています。

Feel free to use or modify the code for your own purposes.  
自由に利用・改変いただけます。
